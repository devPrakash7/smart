<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8" />
    <title>Livoso</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="" name="description" />
    <meta content="coderthemes" name="author" />

    <!-- Theme favicon -->
    <link rel="shortcut icon" href="assets/favicon-8fd74f43.ico">
    <script type="module" crossorigin src="assets/theme-e4584917.js"></script>
    <link rel="stylesheet" href="assets/theme-d32f8eb8.css">

</head>

<body class="relative lg:h-screen py-6 flex justify-center items-center bg-auto bg-no-repeat bg-primary/10"
    style="background-image: url('assets/auth-bg-f57aaf4d.png');">
    <div class="container">
        <div class="flex justify-center">
            <div class="lg:w-1/3 md:w-2/3 w-full relative">
                <div class="relative bg-white rounded-lg shadow-lg p-6 z-10 dark:bg-default-50">
                    <a href="#" class="block mb-8">
                    </a>

                    <form action="#">
                        <h4 class="text-2xl font-semibold text-default-800 mb-4">Forgot Password</h4>
                        <div class="lg:my-30">
                            <div class="mb-4">
                                <label for="old_password"
                                    class="block text-base/normal font-semibold text-default-900 mb-2">Old
                                    Password</label>
                                <input
                                    class="block w-full rounded py-2.5 px-4 bg-transparent border-default-200 text-default-900 focus:outline-0 focus:ring-0"
                                    type="password" id="old_password" placeholder="Enter your old password">
                            </div>

                            <div class="mb-4">
                                <label for="new_password"
                                    class="block text-base/normal font-semibold text-default-900 mb-2">New
                                    Password</label>
                                <input
                                    class="block w-full rounded py-2.5 px-4 bg-transparent border-default-200 text-default-900 focus:outline-0 focus:ring-0"
                                    type="password" id="new_password" placeholder="Enter your new password">
                            </div>

                            <div class="mb-4">
                                <label for="confirm_password"
                                    class="block text-base/normal font-semibold text-default-900 mb-2">Confirm
                                    Password</label>
                                <input
                                    class="block w-full rounded py-2.5 px-4 bg-transparent border-default-200 text-default-900 focus:outline-0 focus:ring-0"
                                    type="password" id="confirm_password" placeholder="Confirm your new password">
                            </div>

                            <div class="flex flex-col justify-center gap-4 mb-6">
                                <button onclick="submitForm();" href="#"
                                    class="relative inline-flex items-center justify-center px-6 py-3 rounded text-base bg-primary text-white capitalize transition-all hover:bg-primary-500 w-full">Reset
                                    Password</button>
                                <a href="auth-login.html"
                                    class="inline-flex items-center justify-center px-3 py-3 w-full rounded bg-primary/20 text-primary hover:bg-primary hover:text-white transition-all">Go
                                    to Login</a>
                            </div>
                        </div>

                        <div class="flex lg:flex-row flex-col gap-3 text-center justify-around mt-6">
                            <a href="#" class="text-base text-default-700">Terms & Conditions</a>
                            <a href="#" class="text-base text-default-700">Support</a>
                            <a href="#" class="text-base text-default-700">Customer Care</a>
                        </div>
                    </form>
                </div>

                <div class="lg:flex hidden">
                    <div class="absolute start-0 bottom-0 -ms-[11.75rem] -z-0">
                        <img src="assets/auth-cardbg-1-5e4948cf.png" alt="" class="">
                    </div>

                    <div class="absolute end-0 bottom-0 -me-36 -z-0">
                        <img src="assets/auth-cardbg-2-8584e00f.png" alt="" class="">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed bottom-5 end-5 flex flex-col items-center bg-primary/25 rounded-full z-10 print:hidden">
        <button
            class="h-0 w-8 opacity-0 flex justify-center items-center transition-all duration-500 translate-y-5 z-10"
            data-toggle="back-to-top">
            <i class="h-5 w-5 text-primary-500 mt-1" data-lucide="chevron-up"></i>
        </button>
        <button class="rounded-full h-10 w-10 bg-primary text-white flex justify-center items-center z-20">
            <i class="h-5 w-5" data-lucide="sun" id="light-theme"></i>
            <i class="h-5 w-5" data-lucide="moon" id="dark-theme"></i>
        </button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>

        async function submitForm() {

            try {

                const new_password = document.getElementById('new_password').value;
                const old_password = document.getElementById('old_password').value;
                const confirm_password = document.getElementById('confirm_password').value;
                 

                if (!old_password || !new_password || !confirm_password) {
                    alert('Please fill in both old_password and new_password and confirm_password fields.');
                    return;
                }


                if (new_password.length <= 8) {
                    alert('Password must be at least 8 characters long.');
                    return;
                }

                if (old_password.length <= 8) {
                    alert('Password must be at least 8 characters long.');
                    return;
                }

                if (confirm_password.length <= 8) {
                    alert('Password must be at least 8 characters long.');
                    return;
                }

                if (new_password !== confirm_password) {
                    alert('new_password and confirm_password are not matched');
                    return;
                }


                const formData = {
                    old_password: old_password,
                    new_password:new_password,
                    confirm_password:confirm_password
                };


                const authToken = localStorage.getItem('token');
                console.log(authToken)

                const response = await axios.post('http://localhost:8001/v1/users/reSet_password', formData , {

                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}` 
                    },
                });

                if (response.status === 200) {
                    alert('Your password successfully changed.');
                    window.location.href = 'auth-login.html';
                }

            } catch (error) {
                console.error('Error during reset-password:', error.message);
            }
        }

    </script>

</body>

</html>